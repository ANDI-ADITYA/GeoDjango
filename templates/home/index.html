{% extends "home/base.html" %}
{% load static %}
{% load leaflet_tags %}

{% block Title %}
	WebGis Geofisika
{% endblock Title %}

{% block Leaflet_css %}

{% endblock Leaflet_css %}

{% block Heading %}

{% endblock Heading %}

{% block Contents %}
	<script> 
		function map_layers(map,option){
		// Add base map tiles from OpenstreetMap
			var street = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
				maxZoom: 20,
				id: 'mapbox/streets-v11',
				tileSize: 512,
				zoomOffset: -1,
				accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw'
			});
			street.addTo(map);
			var satellite = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
				attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
				maxZoom: 20,
				id: 'mapbox/satellite-streets-v11',
				tileSize: 512,
				zoomOffset: -1,
				accessToken: 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NDg1bDA1cjYzM280NHJ5NzlvNDMifQ.d6e-nNyBDtmQCVwVNivz7A'
			});
		
		// Add data map from database with using L.GeoJSON.AJAX plugin.
			var Point = new L.GeoJSON.AJAX("{% url 'maps:data_points' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<div class="container-fluid rounded-lg p-1 my-1 bg-light text-dark"><table style="width:100%"> <tr><td>Name</td> <td>: '+feature.properties.name.toString()+'</td></tr> <tr><td>Category</td> <td>: '+feature.properties.category.toString()+'</td></tr></table></div>');
				},
			});
			Point.addTo(map);
			var Administrasi = new L.GeoJSON.AJAX("{% url 'maps:data_administrasi' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<div class="container-fluid rounded-lg p-1 my-1 bg-light text-dark"><table style="width:100%"> <tr><td>Name</td> <td>: '+feature.properties.namobj.toString()+'</td></tr> <tr><td>Note</td> <td>: '+feature.properties.remark.toString()+'</td></tr> <tr><td>Layer Code</td> <td>: '+feature.properties.lcode.toString()+'</td></tr> <tr><td>District</td> <td>: '+feature.properties.wadmkk.toString()+'</td></tr> <tr><td>Province</td> <td>: '+feature.properties.wadmpr.toString()+'</td></tr> <tr><td>District Capital</td> <td>: '+feature.properties.wiadkk.toString()+'</td></tr> <tr><td>Area (Hectares)</td> <td>: '+feature.properties.shp_area.toString()+' ha</td></tr></table></div>');
				},
			});
			var Street = new L.GeoJSON.AJAX("{% url 'maps:data_street' %}",{
				onEachFeature: function(feature, layer){
					layer.bindPopup('<div class="container-fluid rounded-lg p-1 my-1 bg-light text-dark"><table style="width:100%"> <tr><td>Name</td> <td>: '+feature.properties.name.toString()+'</td></tr> <tr><td>Category</td> <td>: '+feature.properties.category.toString()+'</td></tr> <tr><td>Region</td> <td>: '+feature.properties.condition.toString()+'</td></tr></table></div>');
				},
			});

		// Add control layers
			var baseLayers = {
				"Streets": street,
				"Satellite": satellite
			}
			var overlayMaps = {
				"Layers": {
					"Building": Point,
					"Streets": Street,
					"Administrasi": Administrasi
				}
			};
			L.control.groupedLayers(baseLayers, overlayMaps).addTo(map);
		}
	</script>
	
	{% leaflet_map "gis" callback="window.map_layers" %}
{% endblock Contents %}




